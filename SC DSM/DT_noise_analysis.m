function [H1,H2,H3,vn,Noise]=DT_noise_analysis(a,b,Tsa,OSR,Ron,gm)
   k=1.38e-23;
   T=400;
   x=2*Ron*gm;
   c1=2.5e-12;
   c2=2.5e-12;
   c3=2.5e-12;
   C1=[c1*a(1),c2*a(2)];
   CF=[c2*b(1),c3*b(2)];
   C2=[c1,c2,c3];
   %tau=(2*Ron+1/gm)*C1;
   vn=ones(1,3);
   vn(1)=2*k*T*(1+1/6/(1+x))/C1(1);
   vn(2)=2*k*T*(1+1/6/(1+x))/C1(2)+2*k*T/C2(1)*(1+b(1));
   vn(3)=2*k*T/C2(2)*(1+b(2));
   fs=1/Tsa*2*pi;
   vn_temp=vn*2;
   vn=vn/fs*2;
   z=tf('z',Tsa);
   INT=1/(z-1);
   L0=INT^2;
   L1=INT^2+a(2)*INT;
   H1=L0/(L1+1);
   L0=INT;
   H2=L0/(L1+1);
   L0=1;
   H3=L0/(1+L1);
   Noise=zeros(1,3);
   Nfft=32*OSR;
   [h,~]=freqz(H1.Numerator{1},H1.Denominator{1},Nfft);
   Noise(1)=dbp(1/Nfft*pi*vn(1)*sum(abs(h(2:Nfft/OSR+1)).^2));
   [h,~]=freqz(H2.Numerator{1},H2.Denominator{1},Nfft);
   Noise(2)=dbp(1/Nfft*pi*vn(2)*sum(abs(h(2:Nfft/OSR+1)).^2));
   [h,~]=freqz(H3.Numerator{1},H3.Denominator{1},Nfft);
   Noise(3)=dbp(1/Nfft*pi*vn(3)*sum(abs(h(2:Nfft/OSR+1)).^2));
   vn=vn_temp;
end